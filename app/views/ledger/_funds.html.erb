<% balances = local_assigns.fetch(:model) %>
<table class="table table-striped table-dark ct-table ct-table-head">
  <thead>
  <tr>
    <th class="ledger-col-width text-center">Symbol</th>
    <th class="ledger-col-width text-center">Balance</th>
    <th class="ledger-col-width text-center">Balance (<%= ref_char %>)</th>
  </tr>
  </thead>
</table>
<div class="ct-table-body-parent-footer">
  <table class="table table-striped table-dark ct-table">
    <tbody>
    <%
      total_usd = 0
    %>
    <% balances.each do |entry| %>
      <% price_usd = entry.current_usd
         balance_usd = 'n.a.'
         if price_usd != -1
           balance_usd = entry.count * price_usd
           total_usd += balance_usd
           next if balance_usd.abs < 0.1 || entry.count.abs < 0.0001
         end

      %>
      <tr>
        <td><%= render 'shared/cell', content: entry.symbol %></td>
        <td><%= render 'shared/cell', content: num_norm(entry.count) %></td>
        <td><%= render 'shared/cell', content: usd_to_ref_norm(balance_usd) %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
<table class="table table-striped table-dark ct-table">
  <tfoot>
  <tr>
    <td><%= render 'shared/cell', content: "Total (#{ref_char})" %></td>
    <td></td>
    <td><%= render 'shared/cell', kind: total_usd > 0 ? 'info' : 'warning', content: usd_to_ref_norm(total_usd) %></td>
  </tr>
  </tfoot>
</table>
